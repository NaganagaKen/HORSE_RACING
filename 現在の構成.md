# 現在の構成

## 現在の処理
- 最低限の前処理（common_process）
  - レース前に知ることが出来ない情報を削除
    - 着差タイム
    - 走破タイム
    - 通過順1-4角
    - 上がり3Fタイム
    - 上がり3F順位
    - Ave-3F
    - PCI
    - -3F差
    - win_odds (これは馬券売買終了後に確定するため、データリークとなり得る)
    - prize
  - 分割用変数（id_for_fold）を作成
  - ターゲット変数の作成
    - 1着を1, それ以外を0としたtarget列を作成
    - rank列を削除

- バリテーションの工夫
  - 自作モジュールで時系列順かつグループは同じfoldになるように分割する。

- lightGBMで予測
  - 5分割
  - パラメータ調整はなし
  - predict_probaで確率予測

- 各レースごとに予測確率を正規化し、正規化した確率がオッズより低いかどうかを検証する。


## 備忘録
- 確率の予測はloglossで評価（確率の確実性を表す指標、小さいほど良い）
- キャリブレーションをすることで決定木の出す確率を滑らかにする。
- レース内の確率で正規化する。（これにより、レースごとの頭数の問題を補正可能）
- これをloglossで評価
- 競馬は時系列データであることに注意。（特にfoldの分割方法）
